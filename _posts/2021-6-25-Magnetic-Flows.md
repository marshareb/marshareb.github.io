---
layout: post
title: Magnetic Flows
tag: dynamics
categories: ["Dynamics"]
---

In this post, I discuss a variety of definitions for the magnetic flow.

# Introduction

I've been learning a lot about magnetic flows recently in the hopes of starting a project on them. The issue is that a lot of the data is spread out in papers, so I'm hoping to collect a lot of it into one place. This will probably be the start to be a series of posts covering some of the major jumps in magnetic flows to date.

# Definitions

We'll be restricting ourselves to the case of a closed, orientable surface. In this scenario, there are four equivalent definitions for what a magnetic flow is. We'll start with the most general and work our way down from there.

## Definition 1

Let $$M$$ be a smooth manifold. Let $$\sigma$$ be a closed $$2$$-form on $$M$$, and let $$\pi : T^*M \rightarrow M$$ be the footprint map. Recall from symplectic geometry (see for example [here](https://www.asc.ohio-state.edu/terekcouto.1/teaching/SG_su21) or [here](https://arxiv.org/pdf/math/0505366.pdf)) that $$T^*M$$ comes equipped with a standard symplectic form, denote it $$\omega$$. Then the **magnetic symplectic form** is defined by

$$ \omega_M := \omega + \pi^*(\sigma).$$

Note that this is a magnetic form on the *cotangent bundle*. If we suppose there is a Riemannian metric $$g$$ (also sometimes denoted by $$\|\cdot\|$$) on $$M$$, then we can use the so called [musical isomorphism](https://en.wikipedia.org/wiki/Musical_isomorphism) $$\hat{g} : TM \rightarrow T^*M$$ and thus define the **magnetic symplectic form** on the tangent bundle by setting $$\hat{g}^*(\omega_M) = \omega_M^T$$ (where the $$T$$ stands for tangent). We'll be a little sloppy and just write $$\omega_M$$ for the magnetic symplectic form on whatever bundle we're looking at. Take the standard energy Hamiltonian $$H : TM \rightarrow \mathbb{R}$$ defined by

$$ H(x,v) := \|v\|_x^2.$$

**Remark:** There's sometimes a factor of $$1/2$$ in the energy Hamiltonian, but it's just a matter of preference with the constants.

Then taking the [symplectic gradient](https://ncatlab.org/nlab/show/symplectic+gradient) with respect to this Hamiltonian, we get a vector field $$F$$ on $$TM$$ satisfying $$i_{F}(\omega_M) = dH.$$

**Remark:** This sometimes might be written $$-dH$$, it's just a matter of preference with the signs.

Let $$SM$$ denote the unit tangent bundle, which we can also recognize as $$H^{-1}(1)$$. In fact, what we could do is examine any **energy surface,** defined by $$\Sigma_c := H^{-1}(c)$$. We observe that the Hamiltonian is a constant of motion for the flow $$\phi^t$$ generated by $$F$$ (which exists by existence and uniqueness of ODEs). This is an easy calculation:

$$ \frac{d}{dt} H(\phi^t(x)) = dH(\phi^t(x)) (\dot{\phi}^t(x)) = \omega(F(\phi^t(x)), \dot{\phi}^t(x)) = 0.$$

Thus we see that we can define flows $$\phi^t : \Sigma_c \rightarrow \Sigma_c$$ for any $$c \in \mathbb{R}$$. The magnetic flow is generally thought of as being restricted to one of these energy surfaces. There's a lot of work on studying whether there's always a closed orbit of the magnetic flow -- studying something called Mane's critical value (see [here](https://www.cimat.mx/reportes/enlinea/I-02-10.pdf) for example), we're able to study properties of these closed orbits on different energy surfaces (as well as study whether the flow is contact). In our case, we'll just restrict the case of the unit tangent bundle, so we'll only be looking at $$SM = \Sigma_1.$$ Thus given three bits of information, namely $$(M, g, \sigma)$$, we can determine a unique magnetic flow $$\phi^t : SM \rightarrow SM$$. Some authors will just use the tuple to denote the magnetic flow when it's clear.

A first question to explore is the relationship of this metric with the magnetic flow. Some authors like to instead do the following procedure: take the canonical symplectic form $$\omega$$, push it through the musical isomorphism to get $$\omega' := \hat{g}^*(\omega)$$, and then define the magnetic symplectic form on the tangent bundle by

$$ \omega_M := \omega' + \pi^*(\sigma),$$

where now $$\pi : TM \rightarrow M$$ is the footprint map. Are these two things the same? To differentiate things, let's denote $$\pi' : T^*M \rightarrow M$$. Then the question really boils down to whether $$\pi^*(\sigma) = (\hat{g})^*(\pi')^*(\sigma).$$ The answer, it turns out, is yes, since the musical isomorphism admits a nice commutativity property when it comes to projections (this is by virtue of being a bundle isomorphism). So either definition is equivalent for constructing the magnetic symplectic form on the tangent bundle.

To summarize this section, given the tuple of information $$(M, g, \sigma)$$, one can construct the magnetic flow on any energy surface $$\Sigma_c$$ by taking the symplectic gradient of $$dH$$ and then looking at the corresponding flow it generates restricted to the energy surface.

**Remark:** In the above definition, we assumed that the $$2$$-form is only closed. Sometimes we'll call the symplectic form the **magnetic system.** In the case where the the $$2$$-form is exact, we'll call the magnetic system an **exact magnetic system.**

## Definition 2

Alternatively, we could restrict ourselves to the framework of the cotangent bundle for as long as possible by pushing the metric from $$TM$$ to $$T^*M$$. So letting $$\omega$$ again denote the canonical symplectic form on $$T^*M$$ and $$\sigma$$ some closed $$2$$-form on $$M$$, we can take the magnetic symplectic form $$\omega_M := \omega + (\pi')^*(\sigma)$$. Using the musical isomorphism again, we can transport the metric from $$TM$$ to $$T^*M$$, so we get a metric $$g'$$ on $$T^*M$$ via $$(\hat{g}^{-1})^*(g) =: g'.$$ We can also denote this new metric by $$\|\cdot\|'$$. With this, we can define the Hamiltonian $$H' : T^*M \rightarrow \mathbb{R}$$ by

$$H'(x,\xi) := (\|\xi\|'_x)^2.$$

Again, we get resulting energy surfaces $$\Sigma_c' := (H')^{-1}(c)$$, and taking the symplectic gradient we get a vector field $$F'$$ satisfying $$i_{F'}(\omega_M) = dH'.$$ This then gives us a flow on $$S^*M$$, called the **comagnetic flow**. Working through the calculations, one can see that $$F$$ (generating the magnetic flow) and $$F'$$ are related by $$\hat{g}(F) = F'$$. In fact, we can deduce from a similar calculation that the flows are conjugate via the musical isomorphism. Thus information we have on the comagnetic flow translates to information on the magnetic flow. So while the flows are necessarily different flows, from a dynamics perspective it's all the same.

## Definition 3

The next approach is a differential equations approach to magnetic flows, assuming we're on a closed orientable surface. Fix a complete metric on $$M$$ and let $$\lambda : SM \rightarrow \mathbb{R}$$ be a smooth function. We can look at the family of curves $$\gamma$$ on $$M$$ which satisfy the following partial differential equation:

$$ \frac{D\dot{\gamma}}{dt} = \lambda(\gamma, \dot{\gamma}) i \dot{\gamma}.$$

By $$i$$ we mean the map corresponding to the **almost complex structure**; this is a map which rotates a vector on $$TM$$ by $$\pi/2$$. A curve satisfying this differential equation will be called a **$$\lambda$$-geodesic.** The name arises from the fact that, in the case $$\lambda = 0$$, we get the partial differential equation defining geodesics on the surface. Completeness tells us that there are solutions to the differential equation. Like in the standard geodesic case, we get that there is a unique $$\lambda$$ geodesic associated to every unit tangent vector, and so we can define a flow in the usual fashion.

Assuming Cartan's structural equations, we have a moving frame $$\{X,H,V\}$$ on $$TM$$, where $$X$$ is the vector field associated to the geodesic flow, $$V$$ is associated to the vertical vector field, and $$H$$ is associated to the horizontal vector field. Through the duality induced by the musical isomorphism, we get a moving coframe $$\{\alpha, \beta, \psi\}$$ which is dual to the moving frame. Observe that the generator $$F$$ for the $$\lambda$$-geodesic flow is going to be of the form

$$ F = aX + bH + cV.$$

By using duality and the definitions of the forms for the coframe (which we'll just blackbox for now, I'll hopefully come back with a separate post on that, if not I'm using [Merry and Paternain's notes](https://www.dpmms.cam.ac.uk/~gpp24/ipgd(3).pdf)), we can actually calculate the following:

$$a = \alpha(F) = g( \dot{\gamma}, \dot{\gamma} ) = 1,$$

$$b = \beta(F) = g(\dot{\gamma}, i\dot{\gamma}) = 0,$$

$$c = \psi(F) = g( D \dot{\gamma}/dt, i \dot{\gamma}) = \lambda.$$

Thus $$F = X + \lambda V$$. In the case where $$\lambda$$ is actually a function on the manifold, we recover the definition of a magnetic flow. Define a closed $$2$$-form on $$M$$ by

$$\sigma(v,w) = g(\lambda \cdot v, iw).$$

Then consider the magnetic symplectic form generated by $$(M,g,\sigma)$$, $$\omega_M$$. Letting $$\hat{F}$$ be the vector field which is the symplectic gradient of the standard energy Hamiltonian with respect to $$g$$, we claim that $$\hat{F}$$ restricted to the unit tangent bundle is the same as $$F$$ (so that the flows they generate are the same). We see that it suffices to show that

$$ i_{X + \lambda V} \omega_M = dH.$$

This is just a simple calculation (where implicitly we use that $$\omega = -d\alpha$$):

$$ i_{X + \lambda V} \omega_M = - i_X d\alpha - \lambda i_V d\alpha + i_X \pi^*(\sigma) + \lambda i_V \pi^*(\sigma).$$

Notice that $$\pi^*(\sigma)$$ dies when we use $$V$$ (since $$V$$ is the vertical vector field, and this is strictly on the surface) and by definition we have $$-i_X d\alpha = i_X \omega = dH$$, so we really have

$$ i_{X + \lambda V} \omega_M = dH - \lambda i_V d\alpha + i_X \pi^*(\sigma).$$

Now observe that for $$\xi \in T_{(x,v)}TM$$, we have

$$ \lambda i_V d\alpha (\xi) = \lambda g(d\pi(\xi), iv) = g( \lambda \cdot d\pi(\xi), iv) = \sigma(d\pi(\xi), v)$$
$$ = i_X \pi^*(\sigma)(\xi).$$

Thus we have that $$F = \hat{F}$$ and the flows generated are the same. We sometimes refer to $$\lambda$$ in this context as the **magnetic field.**

To summarize, on a surface we can identify a magnetic flow as coming from a metric and a magnetic field. Then the orbits of magnetic flows arise as solutions to a partial differential equation.

## Definition 4

This definition varies slightly. We now assume we're on a closed orientable surface and we assume that we have an exact magnetic system. Thus we have some magnetic symplectic form $$\omega_M = \omega + \pi^*(\sigma)$$ on $$TM$$, and we now assume $$\sigma = d\eta$$ for some $$1$$-form $$\eta$$ (called the **primitive**).

**Remark:** Sometimes people study what are called **weakly exact magnetic systems** (see for example [this](https://arxiv.org/abs/0906.1192) paper by Merry). These are magnetic systems where everything is as above, except the primitive is not necessarily bounded. More on this later.

In this case, we can define a Lagrangian by

$$L(x,v) := \|v\|_x^2 - \eta_x(v).$$

**Remark:** As usual with these things, there is an issue when it comes to constants and signs. Some papers instead use the Lagrangian

$$ L(x,v) := \frac{1}{2}\|v\|_x^2 \pm \eta_x(v).$$

Once we restrict down to the unit tangent bundle, the issues with signs disappear.

From this Lagrangian we can recover what's called an **Euler-Lagrange** flow. To see this, we observe that this is an example of what's called a **Tonelli-Lagrangian.** In other words, it is a Lagrangian which satisfies three conditions:

(1) $$L$$ is smooth.

(2) We have that for all $$(x,v) \in TM$$, $$\frac{\partial^2 L}{\partial v^2}(x,v)$$ is positive-definite.

(3) $$L$$ is superlinear, in the sense that we have

$$\lim_{\|v\|_x \rightarrow \infty} \frac{L(x,v)}{\|v\|_x} = \infty.$$

It's clear that our Lagrangian satisfies all of these properties. Thus the Legendre transform, a map from $$TM$$ to $$T^*M$$ defined by

$$(x,v) \mapsto \frac{\partial L}{\partial v}(x,v),$$

is a diffeomorphism (see, for example, [these notes](https://www.mathi.uni-heidelberg.de/~gbenedetti/1_Arnhold_Summary.pdf)). Associated is the **Tonelli-Hamiltonian**

$$H_L : T^*M \rightarrow \mathbb{R}, \ \ H(x,p) := \sup_{v \in T_xM} \{ p_x(v) - L(x,v)\}.$$

Thus we take the corresponding flow with the Tonelli-Hamiltonian and we get the so-called Euler-Lagrange flow. This gives us the Hamiltonian

$$ H_L(x,v) := \|v + \eta_x(v)\|^2,$$

and applying the Legendre inverse gives

$$ \hat{H}(x, \xi) = \|\xi\|_x^2.$$

This leads us to a really nice observation on magnetic flows. While this only works when the form is exact, we have that a closed form is *locally* exact. So locally we can do a procedure like this, and since this Hamiltonian above preserves volume on the cotangent bundle, it must preserve volume on $$S^*M$$ (or at the very least locally in $$S^*M$$). But this is sufficient for us to deduce that magnetic flows are volume preserving, with respect to the Liouville measure.


## Definition 5

The final definition is the connection between magnetic systems and bundle maps on general manifolds (a connection we saw a bit of in Definition 3). Here we only require $$M$$ be a smooth manifold with a Riemannian metric $$g$$ and a closed $$2$$-form $$\sigma$$. Given a magnetic system on $$TM$$ via $$(M,g,\sigma)$$, we have a bundle map $$E : TM \rightarrow TM$$ defined by

$$\sigma_x(v,w) = g(E_x(v), w).$$

Note that such a bundle map exists due to the metric. This map is sometimes referred to as the **Lorentz force.** Consider the family of curves which are defined by the relation

$$ \frac{D\dot{\gamma}}{dt} = E_\gamma(\dot{\gamma}),$$

sometimes also written as

$$\nabla_{\dot{\gamma}}\dot{\gamma} = E(\dot{\gamma}).$$

Observe in the case of a closed, orientable surface, we can use our $$\lambda$$-geodesic definition to recover the equivalence. This, in fact, holds in general. The trick is to identify $$T_{(x,v)}TM \cong T_xM \oplus T_xM$$ (see, for example, [this](https://marshareb.github.io/Sasaki/)), where vectors on the left are vertical and the vectors on the right are horizontal. If $$(x,v)$$ is parameterized by some curve $$(s(t), r(t))$$, then take the tangent vector $$(\xi, \eta) \in TM$$ satisfying

$$ \xi = \frac{ds}{dt}, \ \ \eta = \frac{dr}{dt}.$$

Then in these coordinates, the vector field defined by the differential equation turns into

$$F = \left(\dot{\gamma}, \frac{D \dot{\gamma}}{dt} \right).$$

Due to laziness, I'll write the Sasaki metric with the same notation as the normal metric. The canonical symplectic form in these coordinates will look like

$$\omega((\xi_1, \eta_1), (\xi_2, \eta_2)) = g(\xi_2, \eta_1) - g(\xi_1, \eta_2).$$

Thus:

$$\omega_M(F, (\xi, \eta)) = \omega_M\left(\left(\gamma, \frac{D \dot{\gamma}}{dt} \right), (\xi, \eta)\right),$$

$$ \omega \left(\left(\dot{\gamma}, \frac{D \dot{\gamma}}{dt} \right), (\xi, \eta)\right) = g\left( \frac{D\dot{\gamma}}{dt}, \xi\right) - g(\dot{\gamma}, \eta)$$
$$ = g(E(\dot{\gamma}), \xi) - g(\dot{\gamma}, \eta),$$

$$ \pi^*(\sigma)\left(\left(\dot{\gamma}, \frac{D \dot{\gamma}}{dt} \right), (\xi, \eta)\right) = g(E(\dot{\gamma}), \xi),$$

$$ dH((\xi, \eta)) = 2 g(E(\dot{\gamma}), \xi).$$

Observe that we have $$g(\dot{\gamma}, \eta) = 0$$, since we have a horizontal vector with a vertical vector.

# Example

Here we actually build a magnetic flow following [this](https://www.researchgate.net/publication/236210552_Magnetic_flows_on_a_Riemann_surface) paper by Sunada. Let's do the most basic example. Consider the surface $$\mathbb{R}^2$$ and the two form

$$\sigma_s := s dx \wedge dy.$$

The metric here is just the usual inner product on tangent vectors. The goal at this step is to figure out what the morphism $$E$$ is. So given vectors $$v,w \in \mathbb{R}^2$$, we can systematically work through:

$$ \sigma_s(e_1, e_1) = 0 = e_1 \cdot E(e_1),$$

$$ \sigma_s(e_1, e_2) = s = e_1 \cdot E(e_2),$$

$$\sigma_s(e_2,e_1) = -s = e_2 \cdot E(e_1),$$

$$\sigma_s(e_2,e_2) = 0 = e_2 \cdot E(e_2).$$

Using the second and third equation, along with the fact that we have an orthonormal basis, we can deduce that $$E(e_2) = se_1$$ and $$E(e_1) = -se_2.$$ Thus as a matrix, we can represent this as

$$ E = \begin{pmatrix} 0 & s \\ -s & 0 \end{pmatrix}.$$

Now, we know that a curve $$\gamma$$ will be a magnetic geodesic in this case if we can solve

$$ \ddot{\gamma} = E(\dot(\gamma)).$$

In other words, writing $$\gamma(t) = (x(t), y(t))$$, we are trying to solve

$$ \ddot{x}(t) = s \dot{y}(t), \ \ \ddot{y}(t) = -s \dot{x}(t).$$

We break this up into cases. For $$s = 0$$, we get the second derivatives are both zero, so the curves will be lines. This matches what we'd expect. Assuming $$s \neq 0$$, we can use our usual ODE tricks to get

$$x(t) = C + C_1\frac{\sin(st)}{s} - C_2 \frac{\cos(st)}{s},$$

$$y(t) = D + C_2\frac{\sin(st)}{s} + C_1 \frac{\cos(st)}{s},$$

where $$D, C, C_1, C_2$$ are all constants. Thus:

$$ (x(t) - C)^2 + (y(t) - D)^2 = \frac{C_1^2+C_2^2}{s^2}.$$

This completely characterizes the magnetic flow on the Euclidean plane.

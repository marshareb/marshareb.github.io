---
layout: post
title: Guillemin-Kazhdan Isospectral Rigidity
tag: dynamics
categories: ["Dynamics"]
---

In this post, I discuss a the proof of isospectral rigidty on negatively curved surfaces following the argument of Guillemin and Kazhdan.

# Introduction

**EDIT (12/6/21): I (hopefully) have cleaned up some of the proofs here.**

**EDIT (2/27/22): I added some more details.**

The goal of this article is to discuss the proof of [Guillemin-Kazhdan's](https://core.ac.uk/download/pdf/82780825.pdf) isospectral result (we abbreviate Guillemin-Kazhdan as GK). This will most likely fall somewhere in-between what is in the prior paper and what [Merry and Paternain](https://www.dpmms.cam.ac.uk/~gpp24/ipgd(3).pdf) have. In the set up of the problem, we assume a slightly different condition than the usual one for isospectral rigidty. There are two ways I've seen this done:

1) Like in GK, one can say a family of metrics is isospectral if the eigenvalues [Laplace-Beltrami operator](https://en.wikipedia.org/wiki/Laplace%E2%80%93Beltrami_operator) for the corresponding metrics are all the same.

2) A slightly different formulation (as discussed in [Grognet](https://www.cambridge.org/core/journals/ergodic-theory-and-dynamical-systems/article/flots-magnetiques-en-courbure-negative/367C1356787B5F92F3C976BE84990D9B)) is that a family of metrics is isospectral if lengths of "corresponding" geodesics are the same. To be more precise, assume we have a family of metrics $$\{g_s\}$$ and corresponding geodesic flows $$\{\phi_s^t\}$$. Then the family is isospectral if there exists a smooth family of $$C^0$$-conjugacies $$\{h_s\}$$ conjugating $$\phi_s^t$$ and $$\phi_0^t$$ and also satisfying the property that $$h_0 = \text{Id}.$$

The goal of this article is to follow GK's argument using assumption (2) above. We make two observations on the above. First, using Feldman-Ornstein, we see that the $$C^0$$ condition is somewhat unnecessary since we can upgrade it to a $$C^\infty$$-conjugacy. Second, we observe that condition (2) implies that the marked length spectrum is the same between the metrics. Thus with a little more work (i.e. following Otal's proof, see for example [Wilkinson's notes](http://www.math.utah.edu/pcmi12/lecture_notes/wilkinson.pdf)) we can actually deduce that the conjugacies given are the isometries. One interesting question to explore is whether or not we can improve GK's argument to get something like Otal. That is, if we assume the family of conjugacies ahead of time, can we use this Fourier result to prove that the conjugacies are actually the isometries? I am not sure of the result at the time of writing this.

# GK Argument

We now prove the isospectral rigidty result. We first start by stating the theorem with all of the assumptions we'll be using.

**Theorem (GK):** Let $$M$$ be a closed orientable surface. Suppose we have a smooth family of metrics $$\{g_s\}$$ with negative curvature, so the corresponding geodesic flows $$\{\phi_s^t\}$$ are Anosov. If we have a smooth family of $$C^0$$ maps $$\{h_s\}$$ with $$h_0 = \text{Id}$$ and which conjugate $$\phi_s^t$$ and $$\phi_0^t$$, then there exists a smooth family of diffeomorphisms $$f_s : M \rightarrow M$$ with $$f_s^*(g_0) = g_s$$ and $$f_0 = \text{Id}.$$

**Remark:** Negative curvature is not really necessary - what we really need is non-positive curvature and an Anosov geodesic flow.

**Exercise:** After following the argument, check why this is the case.

**Proof:** To start, fix a closed orientable surface $$M$$ along with a metric $$g$$. Together these induce the geodesic flow in the following way: Let $$H : TM \rightarrow \mathbb{R}$$ be the Hamiltonian defined by

$$H(x,v) := g_x(v,v),$$

and let $$\omega$$ be the canonical symplectic form pushed onto $$TM$$ via the musical isomorphism.

**Remark:** Usually this Hamiltonian has a constant $$1/2$$ out front, but it doesn't change too much to ignore this constant for now.

There is a vector field $$X$$ so that

$$i_X(\omega) = dH,$$

and this vector field generates the geodesic flow once we restrict it to an energy surface (in the case of geodesic flow we assume that the energy surface is the unit tangent bundle). Recall from the [prior post](https://marshareb.github.io/Magnetic-Flows/) we have that the flow will be a constant of motion for the Hamiltonian. We will sometimes denote the geodesic flow generated by the vector field $$X$$ as $$(M,g)$$.

We break this up into a series of steps. Our first step is the following:

> **Step 1:** Assume we have a smooth family of metrics $$\{g_s\}$$ and an associated smooth family of Hamiltonians $$\{H_s\}$$. Let
>
> $$\dot{H} := \frac{\partial}{\partial s} H_s \bigg|_{s=0}.$$
>
> We have there is a $$u : SM \rightarrow \mathbb{R}$$ smooth so that $$X(u) = \dot{H}$$.


Assume we have a smooth family of metrics $$\{g_s\}$$, and along with this a family of unit tangent bundles $$S_sM$$. From these, we get corresponding geodesic flows $$\phi_s^t = (M,g_s) : S_sM \rightarrow S_sM$$, and assume that along with these we have a smooth family of $$C^0$$-conjugacies $$\{h_s : S_0M \rightarrow S_sM\}$$. The first observation to make is that these conjugacies preserve lengths of corresponding orbits. Namely if we have a closed orbit for $$\phi_0^t$$, say $$\gamma_0 : [0,T] \rightarrow M$$, and we let $$\gamma_s(t) := \pi(h_s(\gamma_0(t), \dot{\gamma}_0(t)))$$, where $$\pi : TM \rightarrow M$$ is the footprint map. We have the following claim.

**Claim:** Assume we're in the above setting. Let

$$ \dot{H}(x,v) := \frac{\partial}{\partial s} H_s(x,v) \bigg|_{s=0}.$$

We have

$$ \int_0^T \dot{H}(\gamma_0(t), \dot{\gamma}_0(t)) dt = 0.$$

In particular, for any closed orbit $$\gamma$$ of the geodesic flow $$(M, g_0)$ we get

$$ \int_\gamma \dot{H} = 0.$$


**Proof:** Observe that $$H_s(\gamma_s(t), \dot{\gamma}_s(t)) = 1$$ for all $$s, t$$, so

$$ \int_0^T H_s(\gamma_s(t), \dot{\gamma}_s(t))dt = T.$$

Differentiating both sides with respect to $$s$$ leaves us with

$$ \frac{\partial}{\partial s} \int_0^T H_s(\gamma_s(t), \dot{\gamma}_s(t)) dt \bigg|_{s=0} = 0.$$

Now with this in mind we use the fact that $$H_s$$ is a smooth family of Hamiltonians to write

$$H_s = H_0 + s \dot{H} + O(s^2),$$

where

$$\dot{H} = \frac{\partial H_s}{\partial s} \bigg|_{s=0}.$$

Then

$$ 0 = \frac{\partial}{\partial s} \int_0^T [H_0(\gamma_s, \dot{\gamma}_s) + s H_s(\gamma_s, \dot{\gamma}_s) + O(s^2)]dt \bigg|_{s=0}.$$

Calculating the derivative, we get the following:

$$ 0 = \frac{\partial}{\partial s} \int_0^T H_0(\gamma_s, \dot{\gamma}_s)dt \bigg|_{s=0} + \int_0^T \dot{H}(\gamma_0, \dot{\gamma}_0)dt.$$

The goal now is to show that the term on the left is zero. Once we have this, the result will follow. We introduce some new notation to help with this observation. We can use $$\Gamma$$ to denote the variation by defining it as follows:

$$ \Gamma : (-\epsilon, \epsilon) \times [0,T] \rightarrow M, \ \ \Gamma(s,t) := \gamma_s(t).$$

Using $$\Gamma$$ we can define two vector fields:

$$ S := \frac{\partial \Gamma}{\partial s} \bigg|_{s=0}, \ \ T := \frac{\partial \Gamma}{\partial t}.$$

With this in mind, notice that after fixing $$s = 0$$ we can write $$S$$ along the curve as

$$S(t) = x(t) \dot{\gamma}_0(t) + y(t) i \dot{\gamma}_0(t).$$

This should be vague to you. After all, we're dealing with real things, so where did the $$i$$ come from? We define $$i$$ to be the **almost-complex structure**. This is really a bundle morphism which on each vector space takes a vector and sends it to the unique vector obtained by rotating it by $$\pi/2$$ (such an activity makes sense to do since we're on an oriented surface). We'll of course be vague with this and just treat it as a complex number instead of dealing with it as a map.

To make it look a little nicer, we can write $$\dot{\gamma}_0(t)$$ as the vector field $$T(t)$$ along the curve $$\gamma_0(t)$$. We then write the vector field $$i \dot{\gamma}_0(t)$$ as the vector field $$N(t)$$ along the curve $$\gamma_0(t)$$.

Since we're looking at orbits of the geodesic flow, we know that $$\|T\| = 1$$ along the curve. We claim that $$N$$ satisfies two properties:

(1) $$\nabla_T N = 0$$, and

(2) $$\|N\| = 1.$$  

To show this, we work with the differential equation given by $$\nabla_T E = 0$$ and construct an orthogonal vector field along the curve, and then check that it matches with $$N$$. With these facts in mind we see that

$$ \nabla_T S = x'(t) T(t) + y'(t) N(t).$$

Another easy fact to see is that

$$ \nabla_S T = \nabla_T S.$$

This follows easily from noting that

$$ [S,T] = 0,$$

and this follows from just a calculation:

$$ [S,T] = d\Gamma\left( \frac{\partial}{\partial s}, \frac{\partial }{\partial t}\right) = 0.$$

With this in mind let's write out the above term. We have

$$ \frac{\partial }{\partial s}\int_0^T H_0(\gamma_s, \dot{\gamma_s}) dt \bigg|_{s=0} = 2\int_0^T (g_0)_{\gamma_0(t)}(\nabla_{S(t)} T(t), T(t))dt.$$

We'll be sloppy and omit the $$t$$ and the curve $$\gamma_0$$ from here on out. We now note that

$$ (g_0)(\nabla_S T, T) = (g_0)(\nabla_T S, T) = x'(t).$$

Observe that $$x$$ is periodic (as it is defined along the curve) so we have that

$$ \frac{\partial }{\partial s}\int_0^T H_0(\gamma_s, \dot{\gamma_s}) dt \bigg|_{s=0} = \int_0^T x'(t) dt = 0.$$

Thus we're left with

$$ 0 = \int_0^T \dot{H}(\gamma_0, \dot{\gamma}_0)dt,$$

where $$\gamma_0$$ is any closed orbit for $$(M,g_0)$$. $$\blacksquare$$

**Remark:** The proof of this result in [GK](https://core.ac.uk/download/pdf/82780825.pdf) is actually a very slick argument, but we'd have to rework everything above to be in terms of the cotangent bundle for it to work.

By the smooth Livschitz's theorem (for notes on Livschitz's theorem, see [here](https://marshareb.github.io/files/cohomologicalequations.pdf)), we find that this implies there is some $$u$$ so that

$$X(u) = \dot{H}.$$

> **Step 2:** Show that if $$X(u) = \dot{H}$$ then $$u$$ is a $$1$$-form (up to a constant).

We use Cartan's moving frame $$\{X,H,V\}$$. Recall it has the following properties (here quoting [GK](https://core.ac.uk/download/pdf/82780825.pdf)):

(1) $$[V, X] = H,$$

(2) $$[V,H] = -X,$$

(3) $$[X,H] = KV,$$ where $$K$$ is the curvature.

We now want to study Fourier coefficients of functions in $$L^2(SM, \mathbb{C})$$. Our first obstacle to overcome is that these vector fields are derivations defined on $$C^\infty(SM, \mathbb{R})$$. There is a natural way of extending them to complex valued functions, though. For example, to extend $$V$$ to a derivation on $$C^\infty(SM, \mathbb{C})$$ we simply define

$$V(f + ig) = V(f) + iV(g).$$

Note that this transforms $$X,H,$$ and $$V$$ into holomorphic vector fields.

The next hurdle to overcome is to extend $$V$$ to an operator on $$L^2(SM, \mathbb{C})$$. Let $$\rho^t$$ be the **rotation flow** defined by $$V$$ -- this takes a vector $$(x,v) \in SM$$ and rotates the vector $$v$$ by the angle $$t$$. Let $$U_t$$ be the **Koopman operator** associated to this flow. That is, if $$f \in L^2(SM, \mathbb{C})$$, then $$U_t(f) = f \circ \phi^t$$. We make the following observations on the family $$\{U_t\}_{t \in \mathbb{R}}.$$

**Observation 1:** We have that the $$U_t$$ are "flows," in the sense that

$$U_{t+s}(f) = f \circ \rho^{t+s} = f \circ \rho^s \circ \rho^t = U_t(f \circ \rho^s) = U_t U_s.$$

**Observation 2:** We have that, for each $$t \in \mathbb{R}$$, the $$U_t$$ are unitary operators. Recall that a unitary operator on a Hilbert space is a surjective isometry. To see that it is an isometry, observe that

$$ \langle U_t(f), U_t(g) \rangle = \int_{SM} (f \circ \rho^t)\overline{(g \circ \rho^t)} \Omega = \int_{SM} f \overline{g} \Omega = \langle f, g \rangle.$$

Here $$\Omega$$ is the volume form given by $$\alpha \wedge \beta \wedge \psi$$, with $$\alpha, \beta, \psi$$ the forms dual (via the Sasaki metric) to the vector fields $$X,H,V$$ (respectively). The above identity holds since $$V$$ is a volume preserving flow.

Surjectivity follows easily by (1). $$\blacksquare$$

**Observation 3:** The family is "strongly continuous," in the sense that

$$ \lim_{t \rightarrow t_0} U_t(f) = U_{t_0}(f) \text{ for every } t_0 \in \mathbb{R}, f \in L^2(SM, \mathbb{C}).$$

By (1) it suffices to check it on the identity. This clearly holds for all $$f \in C^\infty(SM, \mathbb{C})$$. To establish it for all $$f \in L^2(SM,\mathbb{C})$$, fix $$\epsilon > 0$$ and let $$g \in C^\infty(SM, \mathbb{C})$$ be such that $$\|g - f\|_{\infty} < \epsilon/3$$. Let $$t_0$$ be sufficiently small so that $$\|U_{t_0}(f) - U_{t}(g)\|_2 < \epsilon/3$$. Then

$$\| U_{t_0}(g) - U_t(g)\|_2 \leq \|U_{t_0}(g) - U_{t_0}(f)\|_2 + \|U_{t_0}(f) - U_t(f)\|_2 + \|U_t(f) - U_t(g)\|_2.$$

Using the volume preserving property again, the above assumptions tell us that

$$\| U_{t_0}(g) - U_t(g)\|_2 \leq \epsilon.$$

The result now follows. $$\blacksquare$$

The reason for checking these conditions is that we can now invoke [Stone's theorem](https://en.wikipedia.org/wiki/Stone%27s_theorem_on_one-parameter_unitary_groups). This let's us define a self-adjoint operator $$-iV$$ on a subset of $$L^2(SM, \mathbb{C})$$. Note that the domain on which it is defined is dense, since the flow has an infinitesmal generator (that is, it is defined on $$C^\infty(SM, \mathbb{C})$$).

Now take $$SM$$. Since this is a compact $$S^1$$ fiber bundle, we may choose a finite open cover $$\{U_i\}_{i=1}^n$$ of $$SM$$ for which the fiber bundle looks like $$S^1 \times M$$. On each fiber, we can understand how $$-iV$$ acts on $$L^2(SU_i, \mathbb{C}) \cong L^2(S^1 , \mathbb{C}) \otimes L^2(M, \mathbb{C})$$. It ignores the functions on the manifold and on the $$S^1$$ component we have that it decomposes into a sum of its eigenspaces. So on this neighborhood, we have

$$L^2(SU_i, \mathbb{C}) = \bigoplus_{k \in \mathbb{Z}} H_k(U_i) \text{ where } H_k(U) := \{f \in L^2(SU_i, \mathbb{C}) \ | \ -iV(f) = kf\}.$$

Now take a partition of unity subordinate to this cover and let $$f \in L^2(SM, \mathbb{C})$$. We get that

$$ f = \sum_{i=1}^n f_i \text{ where } f_i \in L^2(SU_i, \mathbb{C}).$$

For each $$i$$, we can write

$$f_i = \sum_{k \in \mathbb{Z}} f_{i,k} \text{ where } f_{i,k} \in H_k(U_i).$$

Thus:

$$f = \sum_{i=1}^n \sum_{k \in \mathbb{Z}} f_{i,k} = \sum_{k \in \mathbb{Z}} \sum_{i=1}^n f_{i,k} = \sum_{k \in \mathbb{Z}} f_k.$$

We see that

$$-iV(f_k) = kf_k,$$

so

$$L^2(SM, \mathbb{C}) = \bigoplus_{k \in \mathbb{Z}} H_k, \text{ where } H_k := \{f \in L^2(SM, \mathbb{C}) \ | \ -iV(f) = kf\}.$$

This proves **Lemma 3.1** in [GK](https://core.ac.uk/download/pdf/82780825.pdf) and gives details on how to define the operator $$-iV$$ on $$L^2(SM, \mathbb{C})$$.

**Remark:** Throughout, we're really focused on smooth functions. The more important quality of the above is that we can write

$$L^2(SM, \mathbb{C}) \cap C^\infty(SM, \mathbb{C}) = \bigoplus_{k \in \mathbb{Z}} \Omega_k \text{ where } \Omega_k = H_k \cap C^\infty(SM, \mathbb{C}).$$

We work with $$L^2$$ since we want to take advantage of the Hilbert space structure for a few results.

We now define two operators.

$$\eta^- := \frac{X + iH}{2}, \ \ \eta^+ := \frac{X-iH}{2}.$$

**Remark:** These operators are defined backwards in GK since to fit notation we would want $$\eta^+$$ to raise the degree and $$\eta^-$$ to lower the degree.

Define $$\Omega_k = H_k \cap C^\infty(SM, \mathbb{C})$$. Using our extensions described earlier, we claim that $$\eta^{\pm} : \Omega_k \rightarrow \Omega_{k \pm 1}.$$ To see why, observe that

$$\eta^+ + \eta^- = X,$$

$$\eta^+ - \eta^- = iH.$$

Hence

$$ [\eta^+, V] + [\eta^-, V] = [\eta^+ + \eta^-, V] = [X,V] = -H,$$

$$ [\eta^+, V] - [\eta^-, V] = [\eta^+ - \eta^-, V] = i[H,V] = iX,$$

So

$$[\eta^-,V] = \frac{1}{2}(iX - H) = i\left( \frac{X + iH}{2}\right) = i \eta^-,$$

$$[\eta^+, V] = \frac{1}{2}(-H - iX) = -i\left(\frac{X - iH}{2}\right) = -i \eta^+.$$

Now let's take a smooth function $$f$$ in $$\Omega_k$$ and see how $$\eta^-$$ acts on it:

$$ [\eta^-, V] (f) = \eta^- V(f) - V \eta^-(f) \implies V \eta^-(f) = \eta^- V(f) - [\eta^-, v] (f)$$

$$ = ik \eta^-(f) - i \eta^-(f) = i(k-1) \eta^-(f).$$

Thus $$\eta^-(f) \in \Omega_{k-1},$$ and the same argument goes to show that $$\eta^+(f) \in \Omega_{k+1}.$$

These operators are nice, in the sense that they are [elliptic](https://en.wikipedia.org/wiki/Elliptic_operator). This is summarized in **Lemma 3.3** in [GK](https://core.ac.uk/download/pdf/82780825.pdf). In the below lemma, we focus only on the case of $$\eta^+$$, although the case of $$\eta^-$$ is essentially the same.

**Lemma:** The operator $$\eta^+ : \Omega_k \rightarrow \Omega_{k+1}$$ is elliptic and injective for $$k \geq 1$$.

The proof of this is somewhat technical and utilizes ellipticity of the Dolbeault operator. We'll avoid the discussion on the ellipticity of the Dolbeault operator (though once definitions are initialized, it's not too hard to prove -- see [this](https://people.math.umass.edu/~wchen/curve_part1.pdf)) and instead just mention that the details for it can be found in **Lemma 2.1** in [this](https://arxiv.org/pdf/1208.4943.pdf) paper.

They then go on to show that these operators satisfy some nice properties.

**Theorem:** If $$p \in C^\infty(SM)$$ satisfies

$$ p = \sum_{|i| \leq N} p_i, \ \ p_i \in H_i$$

and $$X(q) = p$$ for some $$q \in C^\infty(SM)$$, then

$$q = \sum_{|i| \leq N-1} q_i, \ \ q_i \in H_i.$$

Let's see why this is the case now. First we'll need a lemma (see Lemma 3.4 in [GK](https://core.ac.uk/download/pdf/82780825.pdf)).

**Lemma:** Suppose the curvature satisfies the following bounds:

$$a_0 \leq -K/2 \leq a_1.$$

Let $$n \geq 0$$. Then for all $$f \in H_n$$ which lies also in the domain of $$\eta^+$$ and $$\eta^-$$ we have the following inequality:

$$ \|\eta^-(f)\|^2 + a_0 n \|f\|^2 \leq \|\eta^+(f)\|^2 \leq \|\eta^-(f)\|^2 + a_1 n \|f\|^2.$$

**Proof:** We follow [Merry and Paternain](https://www.dpmms.cam.ac.uk/~gpp24/ipgd(3).pdf). Notice that for any $$f$$ for which things make sense we have

$$\int_{SM} [\eta^+, \eta^-] (f) \bar{f} d\mu = \langle [\eta^+, \eta^-] (f), f \rangle = \frac{1}{2} \langle iKV(f), f \rangle,$$

where $$\mu$$ is the volume measure. Since $$f \in H_n$$, we have $$V(f) = inf$$, so

$$ a_0 n\|f\|^2 \leq \langle [\eta^+, \eta^-] (f), f \rangle = \frac{1}{2} \langle iKV(f), f \rangle \leq a_1 n\|f\|^2.$$

Let $$\Theta$$ be the volume form. Using [Cartan's magic formula](https://en.wikipedia.org/wiki/Cartan_formula) we get that $$L_{\eta^{\pm}}(\Theta) = 0$$. The generalized [integration by parts formula](https://en.wikipedia.org/wiki/Integration_by_parts#Higher_dimensions) tells us

$$ \int_{SM} \eta^+( \eta^-(f) \bar{f}) d\mu = 0 = \int_{SM} \eta^-(\eta^+(f) \bar{f})d\mu.$$

Expanding things, we see

$$ \eta^+( \eta^-(f) \bar{f}) = \eta^+(\eta^-(f)) \bar{f} + \eta^-(f) \eta^+(\bar{f}),$$

$$ \eta^-(\eta^+(f) \bar{f}) = \eta^-(\eta^+(f)) \bar{f} + \eta^+(f) \eta^-(\bar{f}).$$

Thus we see that

$$ \int_{SM} (\eta^+(\eta^-(f)) - \eta^-(\eta^+(f)))\bar{f} d\mu = \int_{SM} [\eta^+, \eta^-] (f) \bar{f} d\mu = \int_{SM} [\eta^+(f) \eta^-(\bar{f}) - \eta^-(f)\eta^+(\bar{f})]d\mu.$$

Observe that

$$\eta^+(\bar{f}) = \overline{\eta^-(f)},$$

so we get

$$ \langle [\eta^+, \eta^-] (f), f \rangle = \int_{SM} [\eta^+, \eta^-] (f) \bar{f} d\mu = \int_{SM} [\eta^+(f) \overline{\eta^+(f)} - \eta^-(f) \overline{\eta^-(f)}]d\mu = \|\eta^+(f)\|^2 - \|\eta^-(f)\|^2.$$

Putting it all together,

$$ a_0 n\|f\|^2 + \|\eta^-(f)\|^2 \leq \|\eta^+(f)\|^2 \leq a_1 n\|f\|^2 + \|\eta^-(f)\|^2. \ \ \ \blacksquare$$

**Proof of Theorem:** Since we write $$X$$ as $$\eta^+ + \eta^-$$, we see that $$X(q) = p$$ implies $$(\eta^+ + \eta^-)(q) = p$$. Apriori we can write

$$q = \sum_{i=-\infty}^\infty q_i.$$

Since we need degrees to align, we get that $$X(q) = p$$ implies that

$$ \eta^+(q_{i-1}) + \eta^-(q_{i+1}) = p_i \text{ for each } i.$$

Assuming $$i > N$$ we get

$$\eta^+(q_{i-1}) + \eta^-(q_{i+1}) = 0.$$

Let's now use the lemma above with this in mind. Focusing on $$q_{i+1}$$, we have that the lemma tells us that

$$ \|\eta^+(q_{i+1})\|^2 \geq \|\eta^-(q_{i+1})\|^2.$$

Using the result, we get the following holds for all $$i > N$$:

$$ \|\eta^+(q_{i+1})\|^2 \leq \|\eta^+(q_{i-1})\|^2.$$

Now $$q$$ is $$C^1$$, so we have decay of Fourier coefficients. In particular, this tells us that $$\eta^+(q_i) = 0$$ for all $$i \geq N$$. Now use the lemma again to see that $$q_i = 0$$ for all $$i \geq N$$. $$\blacksquare$$

**Remark:** The moral of the story is that we can reduce the degree by $$1$$.

Since $$\dot{H}$$ comes from a symmetric $$2$$-tensor (the tensor being the derivative of the metric), we get that $$\dot{H} \in H_{-2} \oplus H_0 \oplus H_2$$. This follows since $$\dot{H}$$ is a real valued quadratic function on $$T_{x_0}$$. Using the above theorem, we know that there is a $$u \in H_{-1} \oplus H_0 \oplus H_1$$ so that $$X(u) = \dot{H}$$. We claim that $$u$$ is a $$1$$-form. To prove this, we'll use the following criteria from [Merry and Paternain](https://www.dpmms.cam.ac.uk/~gpp24/ipgd(3).pdf).

**Claim:** Let $$u : SM \rightarrow \mathbb{R}$$ be a smooth function and let

$$\Psi := V^2(u) + u.$$

Then $$u$$ is a $$1$$-form up to a constant if and only if $$\Psi$$ is constant.

**Proof:** Suppose $$u(x,v) = \delta_x(v) + C$$ with $$\delta$$ a $$1$$-form. We see that

$$V^2(u) = - \delta,$$

so

$$\Psi = V^2(u) + u = -\delta + \delta + C = C.$$

On the other hand, if $$\Psi = C$$ then we can solve an ODE to figure out what $$u$$ should be on the circle $$S_xM$$ for each $$x$$. This will uniquely determine $$u$$ as a $$1$$-form. $$\blacksquare$$

We now have all of the ingredients for showing $$u$$ is a $$1$$-form.

**Claim:** Assume the setting above so that $$X(u) = \dot{H}$$. Then $$u$$ is a $$1$$-form up to a constant.

**Proof:** Notice that we can write $$u = u_{-1} + u_0 + u_1$$ with $$u_i \in H_i$$. Notice as well that

$$V^2(u) = V^2(u_{-1}) + V^2(u_0) + V^2(u_1) = -(u_{-1} + u_1),$$

so using the notation from the last claim we have

$$\Psi = V^2(u) + u = u_0.$$

We're done if we can show that $$u_0$$ needs to be constant. Since $$\dot{H} \in H_{-2} \oplus H_0 \oplus H_2$$ we get

$$\eta^+(u_0) = 0 = \eta^-(u_0).$$

We also know that since $$u_0 \in H_0$$ we have $$V(u_0) = 0$$. Since $$\{\eta^+, \eta^-, V\}$$ span the tangent space at each point, this implies that $$u_0$$ is a constant. $$\blacksquare$$

**Remark:** Let $$\delta = u_{-1} + u_1$$. Then we see that $$X(\delta) = \dot{H}$$, so in particular we can just ignore the constant term in $$u$$.

When something like this happens, we call the metric **trivial**.

> **Step 3:** Show that the metrics are all isometric using the $$1$$-forms.

We observe that the arguments in Steps 1 and 2 were not special to the case $$s=0$$, it was just convenient for notation. What really happens is we now have a family of maps $$\{\dot{H}_s\}$$, where

$$\dot{H}_s = \frac{\partial H_t}{\partial t}\bigg|_{t=s}.$$

We also have a family of geodesic flows, $$X_s$$, and corresponding operators $$\eta_s^+, \eta_s^-$$ which all vary smoothly with $$s$$. For each $$s$$, we have a solution $$u_s$$ to the equation

$$X_s(u_s) = \dot{H}_s.$$

Since everything is smooth (and the operators are [elliptic](https://en.wikipedia.org/wiki/Elliptic_operator)), we get that these solutions also vary smoothly with respect to $$s$$. So we have a family of $$1$$-forms $$\{u_s\}$$ varying smoothly with respect to $$s$$. We follow [Merry and Paternain](https://www.dpmms.cam.ac.uk/~gpp24/ipgd(3).pdf) to finish the proof.

With respect to each $$1$$-form $$u_s$$ we can find a vector field $$Z_s$$ by setting $$Z_s = \hat{g}_s^{-1}(u_s)$$, where $$\hat{g}$$ is the musical isomorphism (equivalently, just view this as the vector field which is dual to $$u_s$$ under the metric). Let's fix $$s=0$$ for notational convenience. Fix $$(x,v) \in TM$$ and let $$\gamma$$ be the curve with $$\gamma(0) = x$$ and $$\dot{\gamma}(0) = v$$. Notice that we have

$$ X(u)(x,v) = \frac{d}{dt} u(\gamma(t), \dot{\gamma}(t)) \bigg|_{t=0} = \frac{d}{dt} g_{\gamma(t)}(Z(\gamma(t)), \dot{\gamma}(t)) \bigg|_{t=0}.$$

Using compatibility of the metric, we can bring this in to get

$$ \frac{d}{ds} (g_s)_x(v,v) \bigg|_{s=0} = \dot{H}(x,v) = X(u)(x,v) = 2 g_x (\nabla_v Z(x), v).$$

Moreover this holds for each $$s$$. It is not too hard to check that this also implies the following condition:

$$ \frac{d}{ds} (g_s)_x(v,w) \bigg|_{s=0} =  g_x (\nabla_v Z(x), w) +g_x (\nabla_w Z(x), v) .$$

The trick is to look at $$(g_s)_x(v+w,v+w)$$ and rewrite it in two different ways.

**Exercise:** Show the above identity.

Correspondingly, we can find a family of diffeomorphisms $$f_s$$ with $$f_0 = \text{Id}$$ and

$$ Z_s = \frac{df_s}{ds} \circ f_s^{-1}.$$

For context see [these lecture notes](http://staff.ustc.edu.cn/~wangzuoq/Courses/16F-Manifolds/Notes/Lec24.pdf).

If we let $$g = g_0$$, then we can define $$g_s' := f_s^*(g).$$ Thus this is the metric satisfying the following:

$$(g_s')_x(v,w) = f_s^*(g)_x(v,w) = g_{f_s(x)}(d_x (f_s)(v), d_x (f_s)(w)).$$

Notice that we have

$$\frac{d}{ds} (g_s')_x(v,w) = \frac{d}{ds} f_s^*(g)_x(v,w) = f_s^*(g)_x( \nabla_{v} Z_s(x), w) + f_s^*(g)_x(\nabla_w Z_s(x), v)$$

$$ = (g_s')_x(\nabla_v Z_s(x), w) + (g_s')_x(\nabla_w Z_s(x), v).$$

Let

$$ (\beta_s)_x(v,w) := \frac{d}{dt} (g_t)_x(v,w) \bigg|_{t=s}.$$

What we've established is that

$$ (\beta_s)_x(v,w) = (g_s)_x(\nabla_v Z_s(x), w) + (g_s)_x(v, \nabla_w Z_s(x)).$$

This is what it means for a symmetric $$2$$-tensor to be **potential**. The connection now is that the metric being trivial implies that the symmetric $$2$$-tensor is potential.

Now we claim that the metrics $$g_s'$$ and $$g_s$$ are the same, so that $$f_s^*(g) = g_s.$$ Notice that the metrics $$\{g_s'\}$$ gives rise to a new family of Hamiltonians $$\{H_s'\}$$. The idea is to show that $$H_s = H_s'$$ and then deduce that the metrics are the same. Let's show that the Hamiltonians are the same.

First notice that $$H_0 = H_0'$$. Next notice that we have

$$ \frac{d}{ds} H_s = \dot{H}_s = L_{Z_s}(H_s)$$

and

$$ \frac{d}{ds} H_s' = \dot{H}'_s = L_{Z_s}(H_s').$$

In particular, they both satisfy the same differential equation with the same initial condition, so they have to be the same function.

Now we deduce the metrics are the same. We see that

$$H_s(x,v) = (g_s)_x(v,v) = (H_s')(x,v) = (g_s')_x(v,v).$$

Thus we get

$$(g_s)_x(v+w, v+w) = (g_s)_x(v,v) + 2 (g_s)_x(v,w) + (g_s)_x(w,w) = (g_s')_x(v,v) + 2(g_s)_x(v,w) + (g_s')_x(w,w).$$

On the other hand,

$$(g_s)_x(v+w,v+w) = (g_s')_x(v+w,v+w) = (g_s')_x(v,v) + 2 (g_s')_x(v,w) + (g_s')_x(w,w).$$

Combining these equations, we get

$$2(g_s)_x(v,w) = 2(g_s')_x(v,w) \implies g_s = g_s'.$$

Thus the metrics are the same and thus we have a smooth family of isometries $$\{f_s\}$$ so that $$f_s^*(g_0) = g_s$$. $$\blacksquare$$

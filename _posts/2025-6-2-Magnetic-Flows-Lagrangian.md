---
layout: post
title: Magnetic flows from a Lagrangian perspective
tags:
  - dynamics
  - geometry
categories:
  - Dynamics
  - Geometry
---

In this post, we discuss magnetic flows from a Lagrangian perspective, building on one of my [old posts](https://marshareb.github.io/Magnetic-Flows/).

# Set up

In an old post, I wrote about a few different (equivalent) ways of thinking about magnetic flows on a surface. However, I didn't really do justice to the Lagrangian perspective, mostly because I was not really aware of it (or the advantages of thinking in this way). The goal of this post is to remediate this, though I am by no means an expert in this way of thinking.
## Differential geometry notation

Before getting into the Lagrangian material, let's discuss notation since we'll be working in local coordinates. Throughout, we assume $N$ is a smooth manifold and $\dim(N) = n$. I'm going to follow along [do Carmo's](https://link.springer.com/book/9780817634902) notation. To that end, we can view our manifold through the charts $(U, \varphi)$, where $U \subseteq \mathbb{R}^n$ and $\varphi : U \hookrightarrow N$ is an injective mapping. When restricted to $x = (x^1, \ldots, x^n) \in U$, the Riemannian metric takes on the form

$$\sum_{k, \ell = 1}^n g_{k\ell}(x) dx^k \otimes dx^\ell. $$

We abuse notation and identify $x$ and $\varphi(x)$. Recall that if we take $v \in T_xN$, then we can write it in local coordinates as

$$v = \sum_{k=1}^n v^k \frac{\partial}{\partial x^k}, $$
and thus the mapping $dx^i : T_xN \rightarrow \mathbb{R}$ is given by $dx^i(v) = v^i$. 

Given a smooth function $f : N \rightarrow \mathbb{R}$ and $x = (x^1, \ldots, x^n)$, we will abuse notation and just write $f(x) = f \circ \varphi(x)$. Furthermore, this allows for us to write

$$ \frac{\partial f}{\partial x}(x) = \left( \frac{\partial f}{\partial x^1}(x), \ldots, \frac{\partial f}{\partial x^n}(x) \right). $$

An easy observation to make is that this induces a map

$$ \frac{\partial f}{\partial x}(x) : T_xN \rightarrow \mathbb{R}, \quad \frac{\partial f}{\partial x}(x)v = \sum_{k=1}^n \frac{\partial f}{\partial x^k}(x) v^k = d_xf(v).$$

Given a smooth function $f : TN \rightarrow \mathbb{R}$, we will be interested in the second derivative. To that end, for $(x,v) = (x^1, \ldots, x^n, v^1, \ldots, v^n)$, we write

$$ \frac{\partial^2 f}{\partial x \partial v}(x,v) = \begin{pmatrix} \frac{\partial f}{\partial x^1 \partial v^1} (x,v) & \cdots &  \frac{\partial f}{\partial x^1 \partial v^n}(x,v) \\  \vdots & \ddots & \vdots \\ \frac{\partial f}{\partial x^n \partial v^1}(x,v) & \cdots & \frac{\partial f}{\partial x^n \partial v^n}\end{pmatrix}. $$

This induces a bilinear form 

$$ \frac{\partial^2 f}{\partial x \partial v}(x,v) : T_xN \times T_xN \rightarrow \mathbb{R}, \quad \frac{\partial^2f}{\partial x \partial v}(x,v)(a,b) = \sum_{k,\ell=1}^n \frac{\partial^2 f}{\partial x^k \partial v^\ell}(x,v)a^k b^\ell.  $$

We can do the same with $\partial^2 x$ and $\partial^2 v$ in the denominator as well. Finally, let's recall that the covariant components of a vector $v = (v^1, \ldots, v^n) \in T_xN$ are given by 

$$ v_k = \sum_{j=1}^n g_{k j}(x) v^j = \left\langle v, \frac{\partial}{\partial x^k} \right\rangle.$$

Recall that this gives us a vector $v^* = \langle v, \cdot \rangle = (v_1, \ldots, v_n) \in T_x^*N$. 

## Anosov definition

Since it will come up later, we recall the definition of an Anosov flow. Let $N$ be a closed manifold (i.e., compact and without boundary), and equip it with some Riemannian metric $g$. 

A flow $\varphi_t : N \rightarrow N$ generated by a vector field $X$ without singular points is *Anosov* if there is a $d\varphi_t$-invariant splitting $TN = E^s \oplus \mathbb{R}X \oplus E^u$ along with constants $C, \lambda > 0$ such that for every $x \in N$, $v^\sigma \in E^\sigma(x)$, and $t \geq 0$, we have 

$$\max\{\|d_x\varphi_t(v^s)\|, \|d_x \varphi_{-t}(v^u)\| \leq C e^{-\lambda t}. $$

The standard example of such a flow is the geodesic flow of a metric with everywhere negative sectional curvature.
# Lagrangian systems

To start, let's recall some of the basic definitions in Hamiltonian and Lagrangian dynamics, following the notes by [Sorrentino](https://arxiv.org/pdf/1011.0590) and the book by [Fathi](https://www.math.u-bordeaux.fr/~pthieull/Recherche/KamFaible/Publications/Fathi2008_01.pdf). Let $N$ be a closed manifold. This post will be working in the smooth category (although one can refine the statements to work for lower regularity as well).
## Lagrangian flows 

To start, Lagrangian flows and dynamics is really a problem of variational calculus. In understanding the extremals, one is able to extract a dynamical system, and the dynamics of this system is connected to these extremal points. We make this a little more precise.

To start, given two points $p,q \in N$, let $C_{p,q}$ be the collection of $C^2$-curves of the form $\gamma :[0,1] \rightarrow N$, where $\gamma(0) = p$ and $\gamma(1) = q$. Recall that a *endpoint-fixed variation* of a curve $\gamma \in C_{p,q}$ is a smooth family of curves $(\gamma_s)_{s \in (-\epsilon, \epsilon)} \in C_{p,q}$ such that $\gamma_0 = \gamma$. Differentiating $\gamma_s$ at $s=0$ yields a vector field $V$ along $\gamma$. The *tangent space* for $C_{p,q}$ consists of all of these variational vector fields $V$; we write $T_\gamma C_{p,q}$ for this collection. Under the appropriate definitions, this turns out to actually be the tangent space in a differential geometry sense, which we'll just accept for the time being.

A *Lagrangian* is a smooth map $L : TN \times \mathbb{R} \rightarrow \mathbb{R}$, and such a Lagrangian induces a functional on $C_{p,q}$. We'll denote this functional by $A_L$, so 

$$ A_L : C_{p,q} \rightarrow \mathbb{R}, \quad A_L(\gamma) := \int_0^1 L(\gamma(t), \dot{\gamma}(t), t) \,dt.$$

In light of the above observation, we can write the differential of this Lagrangian as the map

$$\delta A_L : T C_{p,q} \rightarrow \mathbb{R}, \quad \delta A_L(\gamma, V) := \frac{d}{ds} \Big|_{s=0} \int_0^1 L(\gamma_s(t), \dot{\gamma}_s(t), t) \,dt.$$

We say that $\gamma$ is a *critical point* (or an *extremal*) for $L$ if $\delta A_L(\gamma, \cdot) = 0$. 

**Example:** If $N$ is a Riemannian manifold, then we may be interested in the length functional, which we will write as 

$$ \ell : C_{p,q} \rightarrow \mathbb{R}, \quad \ell(\gamma) = \int_0^1 \|\dot{\gamma}(t)\|\,dt.$$ 
The associated Lagrangian is simply $\ell(x,v) := \|v\|$ (by abuse of notation). In the study of geodesics, we are (generally) interested in minimizing this length functional. For now, let's settle on the following lemma.

**Lemma:** The critical points of the length functional are those curves satisfying $\nabla_{\dot{\gamma}} \left(\dot{\gamma}/\|\dot{\gamma}\| \right) = 0$. 

**Proof:** Notice that 

$$ \delta \ell(\gamma, V) = \frac{d}{ds} \Big|_{s=0} \int_0^1 \langle \dot{\gamma}_s(t), \dot{\gamma}_s(t) \rangle^{1/2} \,dt. $$

Moving the derivative under the integral, we get 

$$ \delta \ell(\gamma, V) = \int_0^1 \frac{1}{\|\dot{\gamma}(t)\|} \langle \nabla_{V(t)} \dot{\gamma}(t), \dot{\gamma}(t) \rangle \,dt.   $$

Next, notice that $\nabla_V \dot{\gamma} = \nabla_\dot{\gamma} V$, so we can write this as 


$$ \delta \ell(\gamma, V) = \int_0^1 \frac{1}{\|\dot{\gamma}(t)\|} \langle \nabla_{\dot{\gamma}(t)} V(t), \dot{\gamma}(t) \rangle \,dt.   $$

Finally, observe that 

$$ \nabla_{\dot{\gamma}(t)} \langle V(t), \dot{\gamma}(t)/\|\dot{\gamma}(t)\| \rangle = \langle \nabla_{\dot{\gamma}(t)} V(t), \dot{\gamma}(t)/\|\dot{\gamma}(t)\| \rangle + \langle V(t), \nabla_{\dot{\gamma}(t)} (\dot{\gamma}(t)/\|\dot{\gamma}(t)\|) \rangle,$$

so

$$ \delta \ell(\gamma, V) =  \left[\left\langle V(1), \frac{\dot{\gamma}(1)}{\|\dot{\gamma}(1)\|} \right\rangle - \left\langle V(0), \frac{\dot{\gamma}(0)}{\|\dot{\gamma}(0)\|} \right\rangle \right] + \int_0^1 \langle V(t), \nabla_{\dot{\gamma}(t)} (\dot{\gamma}(t)/\|\dot{\gamma}(t)\|)\rangle \,dt. $$

Now use that $V(0) = V(1) = 0$ (since this was a fixed point variation), and so if $\gamma$ is a variation, then for all variational vector fields $V$ along $\gamma$, we have

$$ \int_0^1 \langle V(t), \nabla_{\dot{\gamma}(t)} (\dot{\gamma}(t)/\|\dot{\gamma}(t)\|)\rangle \,dt = 0.$$

Since the choice of variational vector field $V$ was arbitrary, the fundamental lemma of the calculus of variations implies the desired conclusion. $\square$ 

**Remark:** Note that this does not say whether these critical points are *extremal points*, i.e., local maxima or minima. For that, we require some more set up, which we will return to later.

From now on, we consider only *autonomous Lagrangians*, i.e., $L(x,v,t) = L(x,v,0)$ for all $t \in \mathbb{R}$ (or, in other words, we do not need this extra time parameter). As observed in the above, the length functional corresponds to an autonomous Lagrangian. Thus, the associated functional on the space $C_{p,q}$ is given by 

$$ A_L : C_{p,q} \rightarrow \mathbb{R}, \quad A_L(\gamma) := \int_0^1 L(\gamma(t), \dot{\gamma}(t)) \, dt.$$ 

At least for a small neighborhood around $(x,v) \in TN$, we can view this as a map $L : \mathbb{R}^{2n} \rightarrow \mathbb{R}$. We now use the shorthand

$$\frac{\partial L}{\partial v}(x,v) = \left( \frac{\partial L}{\partial v_1}(x,v), \ldots, \frac{\partial L}{\partial v_n}(x,v) \right)^T.  $$

Furthermore, observe that $\partial L/\partial v(x,v) : T_xM \rightarrow \mathbb{R}$ is a linear map. With this notation in mind, we will prove the following.

**Lemma:** The critical points of $L$ are precisely those curves $\gamma$ satisfying the *Euler-Lagrange equation* for $L$:

$$ \frac{d}{dt} \frac{\partial L}{\partial v} (\gamma(t), \dot{\gamma}(t)) = \frac{\partial L}{\partial x}(\gamma(t), \dot{\gamma}(t)) \text{ for all } t \in [0,1].$$

**Proof:** Let $\gamma^s$ be the smooth variation associated to $V$. Then

$$ \delta A_L(\gamma, V) =  \frac{d}{ds} \Big|_{s=0}\int_0^1 L(\gamma_1^s(t), \ldots, \gamma_n^s(t), \dot{\gamma}_1^s(t), \ldots, \dot{\gamma}_n^s(t))\,dt.$$

Bringing the derivative under the integral, we have

$$ \delta A_L(\gamma, V) = \int_0^1 \left[\frac{\partial L}{\partial x}(\gamma(t), \dot{\gamma}(t)) \cdot V(t) + \frac{\partial L}{\partial v}(\gamma(t), \dot{\gamma}(t)) \cdot \dot{V}(t) \right] \,dt,$$

here interpreting everything on $\mathbb{R}^{2n}$. Now observe that 

$$\frac{\partial L}{\partial v}(\gamma(t), \dot{\gamma}(t)) \cdot \dot{V}(t)  = \frac{d}{dt} \left[\frac{\partial L}{\partial v}(\gamma(t), \dot{\gamma}(t)) \cdot V(t) \right] - \frac{d}{dt} \left[\frac{\partial L}{\partial v}(\gamma(t), \dot{\gamma}(t))\right] \cdot V(t), $$

and so, substituting this in, we have shown that $\delta A_L(\gamma, V) = 0$ for all variational vector fields $V$ if and only if the Euler-Lagrange equation is satisfied. $\square$ 

If we can solve this differential equation, then we can get a flow associated to this Lagrangian. Notice that in local coordinates, we can rewrite the Euler-Lagrange equation as

$$ \frac{\partial^2 L}{\partial x \partial v}(\gamma(t), \dot{\gamma}(t)) \dot{\gamma}(t)+ \frac{\partial^2L}{\partial v^2}(\gamma(t), \dot{\gamma}(t)) \ddot{\gamma}(t) = \frac{\partial L}{\partial x}(\gamma(t), \dot{\gamma}(t)) \text{ for all } t \in [0,1]. $$

We say that the Lagrangian is *non-degenerate* if 

$$ \det\left(\frac{\partial^2 L}{\partial v^2}(x,v)\right) \neq 0,$$

or, in other words, the Hessian is non-degenerate. This is also referred to as the *Legendre condition* for the Lagrangian; this tells us that we can define a vector field $X_L$ on $TN$ such that the integral curves of this vector field are precisely the curves satisfying the Euler-Lagrange equation, and we refer to the flow associated to this Lagrangian as the *Lagrangian flow*.

The *Legendre transform* of $L$ is the map

$$\mathcal{L} : TM \rightarrow T^*M, \quad \mathcal{L}(x,v) := \left(x, \frac{\partial L}{\partial v}(x,v) \right).$$

Working in local coordinates and using the inverse function theorem, one can show the following.

**Lemma:** The Lagrangian is non-degenerate if and only if $\mathcal{L}$ is a $C^\infty$ local diffeomorphism.

**Example:** Consider the length Lagrangian $\ell$ and the energy Lagrangian $E$. We claim that $\ell$ is *not* non-degenerate, while $E$ *is* non-degenerate. First, observe that we can write

$$ \ell(x,v) = \|v\| = \sqrt{\sum_{k, \ell=1}^n g_{k\ell}(x) v^k v^\ell} \quad\text{and}\quad E(x,v) = \frac{\|v\|^2}{2} = \frac{1}{2}\sum_{k, \ell=1}^n g_{k\ell}(x) v^k v^\ell.$$

Next, let's carefully calculate the Hessian of the length Lagrangian. Taking the first derivative, we have

$$ \frac{\partial \ell}{\partial v^k}(x,v) = \frac{1}{2\|v\|} \sum_{i, j =1}^ng_{ij}(x) [ \delta_k^i v^i + \delta^j_k v^j] = \frac{1}{\|v\|} \sum_{i=1}^n g_{kj}(x) v^k = \frac{v_k}{\|v\|}.$$

Using the quotient rule and taking a second derivative, we have

$$ \frac{\partial^2 \ell}{\partial v^k \partial v^\ell}(x,v) = \frac{1}{\|v\|} \left(g_{k \ell}(x) - \frac{v_k v_\ell}{\|v\|^2} \right). $$

The same kind of calculation gives us the Hessian of the energy Lagrangian.

$$ \frac{\partial^2 E}{\partial v^k \partial v^\ell}(x,v) = g_{k\ell}(x). $$

Since the Riemannian metric is non-degenerate, we immediately deduce that $E$ is non-degenerate. On the other hand, observe that 

$$ \frac{\partial^2\ell}{\partial v^k \partial v^\ell}(x,v) v = \frac{1}{\|v\|} \left(\sum_{k=1}^ng_{k \ell}(x) v^k  - v_\ell \right) = 0. $$

This shows that the kernel is non-trivial. $\square$

Now, we can define the *energy* of a Lagrangian to be the function

$$ \mathbb{E}_L : TN \rightarrow \mathbb{R}, \quad \mathbb{E}_L(x,v) := \frac{\partial L}{\partial v}(x,v)v - L(x,v).$$

We observe that the level sets of the energy are invariant sets for the Lagrangian flow.

**Lemma:** For each $k \in \mathbb{R}$, the set $\mathbb{E}_L^{-1}(k)$ is invariant under the Lagrangian flow.

**Proof:** Let $(\gamma(t), \dot{\gamma}(t))$ be an orbit of the Lagrangian flow. Notice that 

$$\frac{d}{dt} \mathbb{E}_L(\gamma(t), \dot{\gamma}(t)) = \frac{d}{dt}\frac{\partial L}{\partial v}(\gamma(t),\dot{\gamma}(t))\dot{\gamma}(t) - \frac{d}{dt}L(\gamma(t),\dot{\gamma}(t)).  $$

Using the chain rule and the Euler-Lagrange equations, this is zero, so it is a first integral of the flow. $\square$ 

**Remark:** We note that the study of curves should instead be on the level of *absolutely continuous* curves, not just $C^2$-curves. However, we will skip over this detail and simply say that everything works for absolutely continuous curves. The curious reader can dive into Chapter 3 of Fathi's book, though if one is frustrated by the statements, one can replace $C_{p,q}$ with the absolutely continuous curves.

**Remark:** While the length Lagrangian $\ell$ fails to be non-degenerate (and so we cannot define a flow on the level of $TM$), we observe that one can still use it to define a flow on the level of the unit-tangent bundle $SM$. The Euler-Lagrange equation for the length functional will simply be

$$ \nabla_{\dot{\gamma}} \left( \frac{\dot{\gamma}(t)}{\|\dot{\gamma}(t)\|} \right) = 0.$$

When restricting to the unit-tangent bundle, we recover $\nabla_{\dot{\gamma}} \dot{\gamma} = 0$, which is precisely the Euler-Lagrange flow for the energy Lagrangian restricted to the unit-tangent bundle. Thus, when restricting ourselves to curves which are parameterized with respect to arclength, we can still work with the Lagrangian flow of $\ell$.
## Minimizers 

We are interested in trying to find curves which minimize the Lagrangian; we refer to these as *$L$-minimizing curves*. As a first observation, we have the following lemma (which is essentially the same as the one found in a standard calculus course).

**Lemma:** If $L$ is a non-degenerate Lagrangian and $\gamma$ is an $L$-minimizing curve, then it is a critical point.

Thus, being a critical point is a *necessary* condition for being a minimizer, but it is not *sufficient*. This should be clear by taking $N = \mathbb{S}^2$ and the length Lagrangian in the previous section; geodesics are clearly not length minimizers in this setting (even though they are critical points). The game of this section is to try to understand sufficient conditions. 

A *Tonelli-Lagrangian* is a non-degenerate Lagrangian $L : TN \rightarrow \mathbb{R}$ which satisfies the following two additional properties:
1. (Superlinearity) for each $A \in \mathbb{R}$, there is a $B(A) \in \mathbb{R}$ such that for all $(x,v) \in TN$ we have $L(x,v) \geq A \|v\| - B(A)$,
2. (Strict convexity) the Hessian $\frac{\partial^2 L}{\partial v^2}(x,v)$ is positive definite for all $(x,v) \in TN$.

The famous *Tonelli theorem* tells us that Tonelli-Lagrangians are the ones for which the integral curves of the Lagrangian vector field to be minimizers.

**Theorem:** If $L$ is a Tonelli-Lagrangian, then for each $p,q \in N$ the map $L : C_{p,q} \rightarrow \mathbb{R} \cup \{\infty\}$ is lower semi-continuous (when equipping $C_{p,q}$ with the topology of uniform convergence). In particular, on any compact subset of $C_{p,q}$, the action $L$ achieves its infimum.

**Remark:** One can relax the requirement that $N$ is a closed manifold to $N$ being a connected manifold, provided superlinearity is checked on fibers above compact subsets of $N$. 

**Example:** The energy Lagrangian is a Tonelli-Lagrangian (although the length Lagrangian fails to be one, as we observed in the previous section).

## Mane critical value

We now write $C^T_{p,q}$ to be the collection of $C^2$-curves $\gamma : [0,T] \rightarrow N$ such that $\gamma(0) = p$ and $\gamma(T) = q$. To keep the notation consistent, we will continue writing $C_{p,q} := C^1_{p,q}$. Given $k \in \mathbb{R}$, we define the *action potential* by 

$$ \Phi_k(p,q) := \inf\left\{ A_{L + k}(\gamma) \mid \gamma \in \bigcup_{T > 0} C_{p,q}^T\right\}.$$

The *Mane critical value* is given by 

$$ c(L) := \inf\{k \in \mathbb{R} \mid \Phi_k(x,x) > -\infty \text{ for some } x \in N\}.$$

One significance of the Mane critical value is the following (see Corollary 2 in the paper by [Contreras, Iturriaga, Paternain, and Paternain](https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=943c4dc6c3ab5d8faec140038af946bb66991118)).

**Theorem:** If $k > c(L)$, then the dynamics of the Lagrangian flow on $\mathbb{E}_L^{-1}(k)$ is conjugate to a reparameterization of the geodesic flow on the unit tangent bundle of an appropriately chosen Finsler metric on $N$.

Given $k \in \mathbb{R}$, we will say that the Lagrangian $L$ is *Anosov at level $k$* if the Lagrangian flow on $\mathbb{E}_L^{-1}(k)$ is Anosov. To that end, we also observe the following (see Theorem B in the paper by [Contreras, Iturriaga, Paternain, and Paternain](https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=943c4dc6c3ab5d8faec140038af946bb66991118)).

**Theorem:** If the Lagrangian $L$ is Anosov at level $k$, then $k > c(L)$.
## Application: Anosov geodesic flows

It is a classical fact in Riemannian geometry that if $(N,g)$ is a closed Riemannian manifold with everywhere negative sectional curvature, then inside of every free homotopy class there is a unique closed geodesic. The aim of this section is to highlight that this is really a fact about Anosov-Lagrangian dynamics. Namely, we wish to discuss the following.

**Theorem:** Let $L$ be a Tonelli-Lagrangian. If the Lagrangian flow is Anosov at level $k$, then inside of every free homotopy class, there is a unique $L$-minimizing curve $\gamma$ with energy $k$.

Let $\widetilde{N}$ be the universal cover of $N$. Recall that the fundamental group $\pi_1(N)$ acts on $\widetilde{N}$ via deck transformations. Given $p \in \widetilde{N}$, let $\gamma \in \pi_1(N)$, and (after lifting the Lagrangian) consider $L : C_{p, \gamma p} \rightarrow \mathbb{R}$. We first observe the *Tonelli's existence and uniqueness theorem*. 

**Theorem:** Suppose $L$ is a Tonelli-Lagrangian on $\widetilde{N}$ which is the lift of a Tonelli-Lagrangian on $N$. Let $d$ be the metric coming from the lifted Riemannian metric on $\widetilde{N}$. If $K \subseteq \tilde{N}$ is compact and $C$ is a strictly positive constant, then there exists a constant $\delta_0 > 0$ such that if $0 < \delta \leq \delta_0$, $x \in K$, and $y \in \tilde{N}$ is such that $d(x,y) \leq C \delta$, then there is a $\gamma \in C_{x,y}$ such that for all $\eta \in C_{x,y}$, we have $L(\gamma) \leq L(\eta)$. Furthermore, equality holds if and only if $\gamma = \eta$. 

In particular, the Lagrangian satisfies all of the desired assumptions. Using the path-connectedness of the universal cover, completeness of the geodesic flow, and the above theorem, one can construct an $L$-minimizing curve $\gamma$ connecting $p$ and $\gamma p$. This then projects down to a closed curve which is $L$-minimizing. This proves the following.

**Lemma:** In every free homotopy class, there is a closed $L$-minimizing curve.

Uniqueness is a more challenging proposal, and outside the (current) scope of this note; we simply note that it involves the Palais-Smale condition, and we point the reader to the paper by [Contreras, Iturriaga, Paternain, and Paternain](https://www.cimat.mx/~gonzalo/papers/psf.pdf). 

Let $E$ be the energy Lagrangian and let $\ell$ be the length Lagrangian. Suppose that the geodesic flow on the unit-tangent bundle is Anosov. As discussed earlier, there is no Lagrangian flow for the length Lagrangian due to the fact that it is degenerate. Despite this, we can still say the following.

**Theorem:** If the geodesic flow is Anosov at level $k$, then inside of every free homotopy class, there is a unique $\ell$-minimizing curve $\gamma$ with energy $k$.

**Proof:** We will work at the level $k=1/2$ without loss of generality. First, observe by Cauchy-Schwarz that for any curve $\gamma : [0,T] \rightarrow N$ in a free homotopy class we have 

$$ A_\ell(\gamma)^2 \leq 2 T A_E(\gamma),$$

with equality if and only if $\gamma$ has constant speed. If equality holds and $\gamma$ is parameterized with respect to arclength, then observe that 

$$A_\ell(\gamma)^2 = 2 A_\ell(\gamma) A_E(\gamma) \implies A_E(\gamma) = \frac{1}{2} A_\ell(\gamma). $$

Suppose $\gamma$ minimizes $A_E$ in a free homotopy class, but there is an $\eta : [0,T] \rightarrow N$ in the same free homotopy class which satisfies $A_\ell(\eta) < A_\ell(\gamma)$. Let $\eta'$ be the reparameterization of $\eta$ so that it has unit-speed, and observe that 

$$ A_E(\eta') = \frac{1}{2} A_\ell(\eta) < \frac{1}{2} A_\ell(\gamma) = A_E(\gamma) \leq A_E(\eta'). $$

This gives a contradiction, so if $\gamma$ minimizes $A_E$, then it also minimizes $A_\ell$. $\square$

# Magnetic systems

Now let $N$ be a closed manifold. A *magnetic system* on $N$ will be a pair $(g, \sigma)$, where $g$ is a Riemannian metric on $N$ and $\sigma$ is a closed $2$-form. Associated to this closed $2$-form is an endomorphism of the tangent bundle which we call the *Lorentz force*. Denoting this Lorentz force by $Y : TN \rightarrow TN$, it is uniquely determined by the relationship $\langle Y(x,v),w \rangle = \sigma_x(v,w)$ for all $x \in N$ and $v,w \in T_xN$. Finally, associated to our metric $g$ is the Levi-Civita connection $\nabla$.

With this out of the way, we can now describe what the dynamics of a magnetic flow is. A curve $\gamma : \mathbb{R} \rightarrow N$ is a *magnetic geodesic* if it satisfies the *magnetic geodesic differential equation:*

$$ \nabla_{\dot{\gamma}} \dot{\gamma} = Y(\gamma, \dot{\gamma}).$$

This defines a second order differential equation on $N$, and so to every $v \in TN$ we have a unique magnetic geodesic $\gamma$ with $v = (\gamma_v(0), \dot{\gamma}_v(0))$. In light of this, we can define the *magnetic flow* on the tangent bundle:

$$\varphi_t : TN \rightarrow TN, \quad \varphi_t(v) := (\gamma_v(t), \dot{\gamma}_v(t)).$$

Observe that if $\sigma \equiv 0$ (so $Y \equiv 0$), then we simply recover the geodesic flow. 

In order to connect this to the Lagrangian discussion, we will need to construct an example of a Lagrangian whose Euler-Lagrange equations align with the magnetic geodesic equation. Let's first start with the case where the magnetic form is exact, i.e., $\sigma = d\theta$. To that end, we define the *exact magnetic Lagrangian* as

$$L : TN \rightarrow \mathbb{R}, \quad L(x,v) := \frac{\|v\|^2}{2} + \theta_x(v).$$

As we will need to work in local coordinates, let's rewrite the Lagrangian in local coordinates:

$$L(x,v) = \frac{1}{2} \sum_{i,j=1}^n g_{ij}(x) v^i v^j + \sum_{i=1}^n \theta_i(x)v^i.$$

Let's also write our Lorentz force in local coordinates. Notice that if we write

$$ Y(x,v) = \sum_{i=1}^n Y^i(x,v) \frac{\partial}{\partial x^i} \quad \text{ and } \quad \sigma_x = \sum_{i,j=1}^n \sigma_{ij}(x) dx^i \otimes dx^j,$$
then the relationship $\langle  Y(x,v),w \rangle = \sigma_x(v,w)$ turns into

$$ \sum_{i,j=1}^n g_{ij}(x) w^j Y^i(x,v) = \sum_{i,j=1}^n \sigma_{ij}(x) v^i w^j.$$

In particular, if we take $w = \frac{\partial}{\partial x^j}$, then 

$$Y_j(x,v) = \sum_{i=1}^n g_{ij}(x) Y^i(x,v) = \sum_{i=1}^n \sigma_{ij}(x) v^i = \sum_{i=1}^{j-1} \sigma_{ij}(x) v^i + \sum_{i=j+1}^n \sigma_{ij}(x)v^i.$$

To finish, we need to use the fact that $\sigma = d\theta$, so 

$$ d \left(\sum_{j=1}^n \theta_j(x) dx^j \right) = \sum_{i < j} \left[\frac{\partial \theta_j}{\partial x^i}(x) - \frac{\partial \theta_i}{\partial x^j}(x) \right]dx^i \wedge dx^j.$$

From this, we deduce that 

$$ \sigma_{ij}(x) = \frac{\partial \theta_j}{\partial x^i}(x) - \frac{\partial \theta_i}{\partial x^j}(x).$$

so

$$Y_j(x,v) = \sum_{i=1}^{n} \left[\frac{\partial \theta_j}{\partial x^i}(x) - \frac{\partial \theta_i}{\partial x^j}(x)\right] v^i. $$

With this in mind, we have

$$ \frac{\partial L}{\partial v^k}(x,v) = \sum_{j=1}^n g_{kj}(x) v^j + \theta_k(x) \quad \text{ and }\quad \frac{\partial L}{\partial x^k}(x,v) = \frac{1}{2}\sum_{i,j=1}^n \frac{\partial g_{ij}}{\partial x^k}(x) v^i v^j + \sum_{i=1}^n \frac{\partial \theta_i}{\partial x^k}(x) v^i.$$

Taking the derivative of the left one with respect to $t$ yields

$$ \frac{d}{dt} \frac{\partial L}{\partial v^k}(\gamma(t), \dot{\gamma}(t)) =  \sum_{j=1}^n  g_{kj}(x) \ddot{\gamma}^j(t) + \sum_{i,j=1}^n \frac{\partial g_{kj}}{\partial x^i}(\gamma(t)) \dot{\gamma}^i(t) \dot{\gamma}^j(t)  + \sum_{i=1}^n \frac{\partial \theta_k}{\partial x^i}(\gamma(t)) \dot{\gamma}^i(t).$$

Observe now that 

$$ (\nabla_{\dot{\gamma}(t)} \dot{\gamma}(t))_k = \sum_{j=1}^n  g_{kj}(x) \ddot{\gamma}^j(t) + \sum_{i,j=1}^n \frac{\partial g_{kj}}{\partial x^i}(\gamma(t)) \dot{\gamma}^i(t) \dot{\gamma}^j(t) - \frac{1}{2}\sum_{i,j=1}^n \frac{\partial g_{ij}}{\partial x^k}(\gamma(t)) \dot{\gamma}^i(t) \dot{\gamma}^j(t), $$

and so the Euler-Lagrange equations become

$$ \nabla_{\dot{\gamma}} \dot{\gamma} = Y(\gamma(t), \dot{\gamma}(t)).$$

We say that a magnetic system $(g,\sigma)$ is *weakly exact* if the lift of the $2$-form $\sigma$ to the universal cover $\widetilde{N}$ is exact. For example, if $N$ is a surface with genus at least two, then every magnetic system is weakly exact. By lifting to the universal cover, the above work shows the following lemma.

**Lemma:** Let $(g,\sigma)$ be a weakly exact magnetic system. Every magnetic geodesic on $N$ can be realized as a critical point of the exact magnetic system on the universal cover $\widetilde{N}$. 

Moreover, given a weakly exact magnetic system $(g,\sigma)$, one can define the magnetic flow on $T \widetilde{N}$. Since everything is $\pi_1(N)$-equivariant, this projects down to a flow on $TN$, which aligns with the magnetic flow on $TN$ given through the differential equation. As a consequence, we can think of weakly exact magnetic systems as Lagrangian flows.

Let's also define the *magnetic length* for our exact system by 

$$ \ell : TN \rightarrow \mathbb{R}, \quad \ell(x,v) := \frac{\|v\|}{2} + \theta_x(v).$$


**Remark:** At least for weakly exact magnetic systems, we see that this plays the role of our length functional (in terms of magnetic geodesics being the minimizers of this). It is curious that we have to add this factor of $1/2$, but we will soon see why.

Before moving on, let's quickly observe that

$$ \frac{\partial L}{\partial v}(x,v) v = \sum_{k,j=1}^n g_{kj}(x) v^jv^k + \sum_{k=1}^n \theta_k(x) v^k = \|v\|^2 + \theta_x(v).$$

Thus, the energy of the exact magnetic Lagrangian turns out to be 

$$ \mathbb{E}_L(x,v) = \frac{\partial L}{\partial v}(x,v) v - L(x,v) = \frac{\|v\|^2}{2}.$$

As expected, the level sets of the Lagrangian flow will be the *$s$-sphere bundles* given by $\Sigma_s := \{v \in TM \mid \|v\|^2 = s\}$. We then say that the (weakly) exact magnetic system $(g,\sigma)$ is *Anosov at level $k$* if the Lagrangian flow is Anosov on $\mathbb{E}_L^{-1}(k) =\Sigma_{2k}$. 
## Lagrangian insights to the magnetic flow

Let's now reap the benefits of this new perspective. First, we see that magnetic flows above the Mane critical value are nearly geodesic flows for Finsler metrics.

**Theorem:** Let $(g,\sigma)$ be a weakly exact magnetic system. If $k > c(L)$, then the dynamics of the magnetic flow on $\Sigma_{2k}$ is conjugate to a reparameterization of the geodesic flow on the unit tangent bundle of an appropriately chosen Finsler metric on $N$.

This was, for example, taken advantage of in a paper by [Peyerimhoff and Siburg](https://link.springer.com/article/10.1007/BF02776061) in order to show the following.

**Theorem:** Let $(g,\sigma)$ be a weakly exact magnetic system. If $k > c(L)$, then there exists a constant $A > 1$ such that the magnetic geodesics with energy $k \geq k_0$ are $(A,0)$-quasi-geodesics, with $A \rightarrow 1$ as $k_0 \rightarrow \infty$.

Next, in light of the Mane critical value section, we observe the following which should be compared to Theorem C in the paper by [Burns and Paternain](https://sites.math.northwestern.edu/~burns/papers/magflow/).

**Theorem:** Let $(g,\sigma)$ be a weakly exact magnetic system. If $(g,\sigma)$ is Anosov at level $k$, then $c(L) < k.$

Note that they prove this for *all* magnetic systems, not necessarily the weakly exact ones. Thus, their statement is strictly better than this one. That being said, one can also deduce this for all magnetic systems by observing that if $(g,\sigma)$ is Anosov for some $k$, then it is without conjugate points on that energy level $k$, and hence the universal cover must be $\mathbb{R}^n$. We record this observation in the following.

**Theorem:** For all magnetic systems, if $(g,\sigma)$ is Anosov, then it is weakly exact.

Finally, we can use the results from the previous section to deduce the following.

**Theorem:** Let $(g,\sigma)$ be a magnetic system . If the magnetic flow is Anosov at level $k$, then inside of every free homotopy class, there is a unique magnetic geodesic with energy $k$.

We want to then make one last curious observation about how this statement interacts with the magnetic length proposed earlier. 

**Theorem:** Let $(g,d\theta)$ be a magnetic system. If the magnetic flow is Anosov at level $1/2$, then 
- inside every free homotopy class $\alpha \in \pi_1(N)$ there is a unique closed magnetic geodesic $\gamma_\alpha$ with unit-speed, and
- if $\gamma$ is any other unit-speed curve in the same free homotopy class, then we have that $A_\ell(\gamma_\alpha) \leq A_\ell(\gamma)$. 

**Proof:** First, observe that $A_\ell(\gamma)$ is independent of orientation-preserving reparameterizations of $\gamma$. Indeed, let $\gamma : [0,T] \rightarrow N$, let $\phi : [0,T] \rightarrow [0,S]$ be a smooth map, and let $\gamma' : [0,S] \rightarrow N$ be given by $\gamma' = \gamma \circ \phi$. Then

$$A_\ell(\gamma') = \frac{1}{2} \int_0^S \|\dot{\gamma}'(t)\| \,dt + \int_0^S \theta_{\gamma'(t)}(\dot{\gamma}'(t))\,dt. $$

Now, observe that 

$$ \dot{\gamma}'(t) = \frac{d}{ds}\Big|_{s=t} \gamma(\phi(s)) = \dot{\gamma}(\phi(t)) \dot{\phi}(t).$$

Substitute this in (and use the fact that the reparameterization is orientation preserving, so $\dot{\phi} > 0$) to get 

$$A_\ell(\gamma') = \frac{1}{2} \int_0^S \|\dot{\gamma}(\phi(t))\| \dot{\phi}(t) \,dt + \int_0^S \theta_{\gamma(\phi(t))}(\dot{\gamma}(\phi(t))) \dot{\phi}(t)\,dt. $$

Now, let $u = \phi(t)$, so $du = \dot{\phi}(t) dt.$ In particular, we have

$$A_\ell(\gamma') = \frac{1}{2} \int_0^T \|\dot{\gamma}(u)\| \, du + \int_0^T \theta_{\gamma(u)}(\dot{\gamma}(u)) \, du = A_\ell(\gamma). $$

Thus, given arbitrary $\gamma$ we may reparameterize it so that it has unit-speed. 

Assume for contradiction that given an arbitrary curve $\gamma$ in the free homotopy class $\alpha$, we have $A_\ell(\gamma) < A_\ell(\gamma_\alpha)$. Reparameterize $\gamma$ so that it has unit-speed. Since $\gamma$ and $\gamma_\alpha$ have unit-speed, we have 

$$A_L(\gamma) = \frac{1}{2} \int_0^T \|\dot{\gamma}(t)\|^2 \,dt + \int_0^T \theta_{\gamma(t)}(\dot{\gamma}(t)) \,dt = \frac{1}{2} \int_0^T \|\dot{\gamma}(t)\| \,dt + \int_0^T \theta_{\gamma(t)}(\dot{\gamma}(t)) \,dt =  A_\ell(\gamma),$$

and similarly $A_{L}(\gamma_\alpha) = A_\ell(\gamma_\alpha)$. In particular, this shows that 

$$A_L(\gamma) = A_\ell(\gamma) < A_\ell(\gamma_\alpha) = A_L(\gamma_\alpha) \leq A_L(\gamma), $$

giving us our contradiction. $\square$

**Remark:** It is curious that it's not quite the same length as in the Riemannian case. In particular, there's a normalization issue that arises here (due to the introduction of the integral with $\theta$) which does *not* arise in the Riemannian case. Regardless, this suggests that this is the "correct" notion of length when considering its minimizing properties in connection to the magnetic Lagrangian.

The same theorem holds for weakly exact magnetic systems, but we need to take advantage of a different functional. Suppose that $(g,\sigma)$ is weakly exact, and $\gamma : [0,T] \rightarrow N$ is in the free homotopy class $\alpha$. Let $\Sigma(\gamma)$ be a $2$-chain with boundary $\partial \Sigma(\gamma) = \gamma - \gamma_\alpha$. We instead define the functional 

$$ \ell_{g,\sigma}(\gamma) := \frac{1}{2}\int_0^T \|\dot{\gamma}(t)\|\,dt + \int_{\Sigma(\gamma)} \sigma. $$

Notice that if we lift everything to the universal cover, then (abusing notation) this becomes 

$$ \ell_{g,\sigma}(\gamma) = \frac{1}{2} \int_0^T \|\dot{\gamma}(t)\|\,dt + \int_{\gamma} \theta - \int_{\gamma_\alpha} \theta.$$

In particular, we can use the previous theorem to deduce that $\ell_{g,\sigma}(\gamma_\alpha) \leq \ell_{g,\sigma}(\gamma)$ for any closed curve $\gamma$ in the free homotopy class $\alpha$.